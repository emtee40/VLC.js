From f76dff8151c8027c33628e1cc0de8261dfdbb726 Mon Sep 17 00:00:00 2001
From: Mehdi Sabwat <mehdi@videolabs.io>
Date: Mon, 31 May 2021 00:23:40 +0200
Subject: [PATCH 14/18] contrib: remove deprecated platform

---
 contrib/bootstrap                | 3 ---
 contrib/src/fontconfig/rules.mak | 4 ----
 contrib/src/gcrypt/rules.mak     | 6 ------
 contrib/src/gmp/rules.mak        | 5 -----
 contrib/src/gnutls/rules.mak     | 3 ---
 contrib/src/gpg-error/rules.mak  | 9 ---------
 contrib/src/mpg123/rules.mak     | 4 ----
 contrib/src/postproc/rules.mak   | 3 ---
 8 files changed, 37 deletions(-)

diff --git a/contrib/bootstrap b/contrib/bootstrap
index 6f83d310a2..68db3fbf7c 100755
--- a/contrib/bootstrap
+++ b/contrib/bootstrap
@@ -355,9 +355,6 @@ case "${OS}" in
 	*solaris*)
 		add_make_enabled "HAVE_SOLARIS"
 		;;
-	*nacl*)
-		add_make_enabled "HAVE_NACL"
-		;;
 	*emscripten*)
 	       add_make_enabled "HAVE_EMSCRIPTEN"
 	       ;;
diff --git a/contrib/src/fontconfig/rules.mak b/contrib/src/fontconfig/rules.mak
index f91e6f9f2e..d187d211ae 100644
--- a/contrib/src/fontconfig/rules.mak
+++ b/contrib/src/fontconfig/rules.mak
@@ -54,10 +54,6 @@ FONTCONFIG_ENV += LIBXML2_CFLAGS=`xml2-config --cflags`
 FONTCONFIG_ENV += LIBXML2_LIBS=`xml2-config --libs`
 endif
 
-ifdef HAVE_NACL
-FONTCONFIG_ENV += ac_cv_func_random=no
-endif
-
 DEPS_fontconfig = freetype2 $(DEPS_freetype2) libxml2 $(DEPS_libxml2)
 
 .fontconfig: fontconfig
diff --git a/contrib/src/gcrypt/rules.mak b/contrib/src/gcrypt/rules.mak
index 3139c5e910..0275e21fe8 100644
--- a/contrib/src/gcrypt/rules.mak
+++ b/contrib/src/gcrypt/rules.mak
@@ -72,12 +72,6 @@ ifeq ($(ARCH),aarch64)
 GCRYPT_CONF += --disable-arm-crypto-support
 endif
 endif
-ifdef HAVE_NACL
-GCRYPT_CONF += --disable-asm --disable-aesni-support ac_cv_func_syslog=no --disable-sse41-support
-GCRYPT_CONF += --disable-avx-support --disable-avx2-support --disable-padlock-support
-GCRYPT_CONF += --disable-amd64-as-feature-detection --disable-drng-support
-GCRYPT_CONF += --disable-pclmul-support
-endif
 ifdef HAVE_EMSCRIPTEN
 GCRYPT_CONF += --disable-asm --disable-aesni-support ac_cv_func_syslog=no --disable-sse41-support
 GCRYPT_CONF += --disable-avx-support --disable-avx2-support --disable-padlock-support
diff --git a/contrib/src/gmp/rules.mak b/contrib/src/gmp/rules.mak
index 809d8b0edc..d6cd702ce0 100644
--- a/contrib/src/gmp/rules.mak
+++ b/contrib/src/gmp/rules.mak
@@ -13,11 +13,6 @@ ifeq ($(ARCH),mips64el)
 GMP_CONF += --disable-assembly
 endif
 endif
-ifdef HAVE_NACL
-ifeq ($(ARCH),x86_64)
-GMP_CONF += --disable-assembly
-endif
-endif
 ifdef HAVE_EMSCRIPTEN
 GMP_CONF += --disable-assembly
 endif
diff --git a/contrib/src/gnutls/rules.mak b/contrib/src/gnutls/rules.mak
index c0b61a07bd..de03200b50 100644
--- a/contrib/src/gnutls/rules.mak
+++ b/contrib/src/gnutls/rules.mak
@@ -75,9 +75,6 @@ ifeq ($(ARCH),aarch64)
 endif
 endif
 
-ifdef HAVE_NACL
-	GNUTLS_CONF += --disable-hardware-acceleration
-endif
 ifdef HAVE_EMSCRIPTEN
 	GNUTLS_CONF += --disable-hardware-acceleration
 endif
diff --git a/contrib/src/gpg-error/rules.mak b/contrib/src/gpg-error/rules.mak
index 68aa8dd1ff..73491b50ce 100644
--- a/contrib/src/gpg-error/rules.mak
+++ b/contrib/src/gpg-error/rules.mak
@@ -35,15 +35,6 @@ else
 	cp $@/src/syscfg/lock-obj-pub.arm-unknown-linux-androideabi.h $@/src/syscfg/lock-obj-pub.linux-android.h
 endif
 endif
-ifdef HAVE_NACL
-ifeq ($(ARCH),i386) # 32bits intel
-	cp $@/src/syscfg/lock-obj-pub.i686-pc-linux-gnu.h $@/src/syscfg/lock-obj-pub.nacl.h
-else
-ifeq ($(ARCH),x86_64)
-	cp $@/src/syscfg/lock-obj-pub.x86_64-pc-linux-gnu.h $@/src/syscfg/lock-obj-pub.nacl.h
-endif
-endif
-endif
 
 GPGERROR_CONF := $(HOSTCONF) \
 	--disable-nls \
diff --git a/contrib/src/mpg123/rules.mak b/contrib/src/mpg123/rules.mak
index e46f3efd03..545f5e41a2 100644
--- a/contrib/src/mpg123/rules.mak
+++ b/contrib/src/mpg123/rules.mak
@@ -30,10 +30,6 @@ MPG123CONF += --with-cpu=generic_dither
 endif
 endif
 
-ifdef HAVE_NACL
-MPG123CONF += ac_cv_header_sys_select_h=no
-endif
-
 $(TARBALLS)/mpg123-$(MPG123_VERSION).tar.bz2:
 	$(call download_pkg,$(MPG123_URL),mpg123)
 
diff --git a/contrib/src/postproc/rules.mak b/contrib/src/postproc/rules.mak
index d9adb3cb32..4acbb6c5f8 100644
--- a/contrib/src/postproc/rules.mak
+++ b/contrib/src/postproc/rules.mak
@@ -103,9 +103,6 @@ ifdef HAVE_SOLARIS
 POSTPROCCONF += --enable-pic
 endif
 
-ifdef HAVE_NACL
-POSTPROCCONF += --target-os=linux
-endif
 ifdef HAVE_EMSCRIPTEN
 POSTPROCCONF += --arch=wasm32 --target-os=linux
 endif
-- 
2.32.0

